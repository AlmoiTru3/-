#!/usr/bin/env bash

# Номер варианта
TASKID=22

# VAR_1: количество строк в файле
VAR_1=$(wc -l < dns-tunneling.log)

# Обработка DNS-запросов типа A
{
    grep $'\t1\t' dns-tunneling.log | 
    awk -F'\t' '{print tolower($15)}' |
    sort |
    uniq -c |
    awk '{print $2 "\t" $1}' |
    sort -k2,2nr -k1,1
} > results.txt

# VAR_2: количество строк в results.txt
VAR_2=$(wc -l < results.txt)

# Вывод для проверки
echo "TASKID: $TASKID"
echo "VAR_1: $VAR_1"
echo "VAR_2: $VAR_2"
